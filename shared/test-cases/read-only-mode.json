{
  "name": "Read-Only Mode",
  "description": "Tests for read_only mode - only SELECT statements allowed",
  "tests": [
    {
      "sql": "SELECT * FROM users",
      "options": { "mode": "read_only" },
      "expected": {
        "isSafe": true,
        "statementType": "SELECT"
      }
    },
    {
      "sql": "SELECT * FROM products p JOIN categories c ON p.category_id = c.id",
      "options": { "mode": "read_only" },
      "expected": {
        "isSafe": true,
        "tablesContain": ["products", "categories"]
      }
    },
    {
      "sql": "SELECT * FROM (SELECT id, name FROM users) AS t",
      "options": { "mode": "read_only" },
      "expected": { "isSafe": true }
    },
    {
      "sql": "WITH active_users AS (SELECT * FROM users WHERE active = true) SELECT * FROM active_users",
      "options": { "mode": "read_only" },
      "expected": { "isSafe": true }
    },
    {
      "sql": "DROP TABLE users",
      "options": { "mode": "read_only" },
      "expected": {
        "isSafe": false,
        "reasonContains": "DROP"
      }
    },
    {
      "sql": "DELETE FROM users WHERE id = 1",
      "options": { "mode": "read_only" },
      "expected": {
        "isSafe": false,
        "reasonContains": "DELETE"
      }
    },
    {
      "sql": "INSERT INTO users (name) VALUES ('test')",
      "options": { "mode": "read_only" },
      "expected": {
        "isSafe": false,
        "reasonContains": "INSERT"
      }
    },
    {
      "sql": "UPDATE users SET name = 'test' WHERE id = 1",
      "options": { "mode": "read_only" },
      "expected": {
        "isSafe": false,
        "reasonContains": "UPDATE"
      }
    },
    {
      "sql": "TRUNCATE TABLE users",
      "options": { "mode": "read_only" },
      "expected": {
        "isSafe": false
      }
    }
  ]
}



